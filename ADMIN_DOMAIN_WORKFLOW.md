# 超管端域名配置流程图

## 📊 完整配置流程

```
┌─────────────────────────────────────────────────────────────┐
│                    开始配置超管端域名                          │
│                    目标：admin.aizhixuan.com.cn               │
└──────────────────────────┬──────────────────────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤1：登录域名服务商                  │
        │  (阿里云/腾讯云/Cloudflare)           │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤2：添加DNS记录                    │
        │                                        │
        │  类型：CNAME                          │
        │  主机：admin                          │
        │  值：cname.vercel-dns.com            │
        │  TTL：600                            │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤3：保存DNS配置                    │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤4：等待DNS生效                    │
        │  (10-30分钟)                          │
        │                                        │
        │  验证命令：                            │
        │  ping admin.aizhixuan.com.cn        │
        └──────────────────┬───────────────────┘
                           │
                           ▼
                    ┌──────────────┐
                    │ DNS已生效？   │
                    └──────┬───────┘
                  是       │       否
                   │       │       │
                   │       ▼       │
                   │  等待10分钟    │
                   │  重试ping      │
                   │       │       │
                   └───────┴───────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤5：登录Vercel                    │
        │  https://vercel.com                  │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤6：选择项目                      │
        │  pulseopti-hr                        │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤7：进入Settings → Domains        │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤8：添加域名                      │
        │  admin.aizhixuan.com.cn             │
        └──────────────────┬───────────────────┘
                           │
                           ▼
                    ┌──────────────┐
                    │ 配置成功？    │
                    └──────┬───────┘
                  是       │       否
                   │       │       │
                   │       ▼       │
                   │  检查DNS配置  │
                   │  重新添加域名 │
                   │       │       │
                   └───────┴───────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤9：等待HTTPS证书生成              │
        │  (5-10分钟)                           │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤10：访问测试                     │
        │  https://admin.aizhixuan.com.cn     │
        └──────────────────┬───────────────────┘
                           │
                           ▼
                    ┌──────────────┐
                    │ 访问成功？    │
                    └──────┬───────┘
                  是       │       否
                   │       │       │
                   │       ▼       │
                   │  故障排查    │
                   │  (见下文)    │
                   │       │       │
                   └───────┴───────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤11：登录测试                     │
        │                                        │
        │  账号：208343256@qq.com             │
        │  密码：admin123                       │
        └──────────────────┬───────────────────┘
                           │
                           ▼
                    ┌──────────────┐
                    │ 登录成功？    │
                    └──────┬───────┘
                  是       │       否
                   │       │       │
                   │       ▼       │
                   │  检查数据库   │
                   │  检查JWT_SECRET│
                   │       │       │
                   └───────┴───────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │  步骤12：功能验证                     │
        │                                        │
        │  ✓ 用户管理                           │
        │  ✓ 企业管理                           │
        │  ✓ 订阅管理                           │
        │  ✓ 数据同步                           │
        └──────────────────┬───────────────────┘
                           │
                           ▼
        ┌──────────────────────────────────────┐
        │              ✅ 配置完成！             │
        │                                        │
        │  超管端已可外网访问                    │
        │  admin.aizhixuan.com.cn              │
        └──────────────────────────────────────┘
```

---

## 🔍 故障排查流程

```
访问失败？
    │
    ├─ ping不通？
    │   ├─ DNS未生效 → 等待10-30分钟
    │   ├─ DNS配置错误 → 检查CNAME记录
    │   └─ 本地缓存问题 → ipconfig /flushdns
    │
    ├─ Vercel显示"Invalid Configuration"？
    │   ├─ DNS记录类型错误 → 改为CNAME
    │   ├─ 记录值错误 → 改为cname.vercel-dns.com
    │   └─ DNS未生效 → 等待10-30分钟
    │
    ├─ 404错误？
    │   ├─ 项目未部署 → 在Vercel重新部署
    │   ├─ 路由代码缺失 → 检查src/app/admin/
    │   └─ 部署失败 → 查看Build Log
    │
    ├─ HTTPS证书错误？
    │   ├─ 证书未生成 → 等待5-10分钟
    │   ├─ DNS未生效 → 检查DNS配置
    │   └─ 强制更新证书 → Vercel中重新生成
    │
    └─ 登录失败？
        ├─ 账号不存在 → 检查数据库users表
        ├─ 密码错误 → 重置密码
        ├─ JWT_SECRET缺失 → 配置环境变量
        └─ isSuperAdmin=false → 更新为true
```

---

## 🎯 快速操作清单

### DNS配置
- [ ] 登录域名服务商
- [ ] 添加CNAME记录
- [ ] 保存配置
- [ ] 等待生效

### Vercel配置
- [ ] 登录Vercel
- [ ] 选择项目
- [ ] 添加域名
- [ ] 等待证书

### 验证测试
- [ ] ping测试
- [ ] 访问测试
- [ ] 登录测试
- [ ] 功能测试

---

## ⏱️ 时间预估

| 步骤 | 预计时间 | 说明 |
|------|---------|------|
| DNS配置 | 5分钟 | 添加记录 |
| DNS生效 | 10-30分钟 | 需等待 |
| Vercel配置 | 5分钟 | 添加域名 |
| HTTPS生成 | 5-10分钟 | 自动生成 |
| 功能验证 | 10分钟 | 测试功能 |
| **总计** | **35-60分钟** | 包含等待时间 |

---

## 📞 需要帮助？

详细操作步骤：`ADMIN_DOMAIN_CONFIG_STEP_BY_STEP.md`

快速参考：`ADMIN_DOMAIN_QUICK_REFERENCE.md`

系统诊断：`ADMIN_DOMAIN_SETUP_GUIDE.md`
